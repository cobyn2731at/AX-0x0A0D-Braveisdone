# AX-0x0A0D-Braveisdone
#pragma option dll  int _export Base64Encode(dword input, len, buffer, lineBrak) uses ESI EDI EBX {     dword newLine = lineBrak;      $CALL NEAR START     $DB "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"; START:     $POP EDX      EBX = input;     EDI = buffer;     ECX = len;      while(signed ECX > 0)     {         DSBYTE[EDI] = DSBYTE[DSBYTE[EBX] >> 2 + EDX];          EAX = 0;         IF(ECX > 1) EAX = DSBYTE[EBX + 1] &amp; 0xf0 >> 4;         DSBYTE[EDI + 1] = DSBYTE[DSBYTE[EBX] &amp; 3 &lt;&lt; 4 | EAX + EDX];          IF(ECX > 1)         {             EAX = DSBYTE[EBX + 2] &amp; 0xc0 >> 6;             DSBYTE[EDI + 2] = DSBYTE[DSBYTE[EBX + 1] &amp; 0xf &lt;&lt; 2 | EAX + EDX];         } ELSE DSBYTE[EDI + 2] = '=';          IF(ECX > 2) DSBYTE[EDI + 3] = DSBYTE[DSBYTE[EBX + 2] &amp; 0x3f + EDX];         ELSE DSBYTE[EDI + 3] = '=';          EBX += 3;         EDI += 4;         ECX -= 3;         newLine -= 4;         IF(ZEROFLAG)         {             newLine = lineBrak;             AX = 0x0A0D;             $stosw         }     }      DSBYTE[EDI] = 0;     return; }
